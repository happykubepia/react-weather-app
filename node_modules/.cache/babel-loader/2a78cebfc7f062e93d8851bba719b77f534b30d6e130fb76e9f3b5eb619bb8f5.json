{"ast":null,"code":"import jQuery from\"jquery\";import{db}from\"../backend/app_backend\";import Swal from\"sweetalert2\";import*as weatherAPI from\"./getCurrentWeather\";const getGeolocation=()=>{//check if the user's device supports Geolocation API\nif(navigator.geolocation){const OPTIONS={enableHighAccuracy:true,maximumAge:0,timeout:Infinity};const error=error=>{Swal.fire({toast:true,text:error.message,icon:\"warning\",timer:1000,position:\"top\",showConfirmButton:false}).then(willProceed=>{// @see line 52\nweatherAPI.scrollToElement(\"weatherContainer\");});};navigator.geolocation.watchPosition(position=>{//check if the user's position was saved before\nif(!db.get(\"USER_LONGITUDE\")&&!db.get(\"USER_LATITUDE\")){db.create(\"USER_LONGITUDE\",position.coords.longitude);db.create(\"USER_LATITUDE\",position.coords.latitude);}else{//if saved, then get the current weather using their coordinates\njQuery($=>{$.noConflict();const longitude=position.coords.longitude||db.get(\"USER_LONGITUDE\"),latitude=position.coords.latitude||db.get(\"USER_LATITUDE\");const URL=\"https://api.openweathermap.org/data/2.5/weather?lat=\".concat(latitude,\"&lon=\").concat(longitude,\"&appid=\").concat(weatherAPI.API_KEY,\"&units=\").concat(weatherAPI.WEATHER_UNIT);$.ajax({url:URL,processData:false,success:(result,status,xhr)=>{if(xhr.status!=200){Swal.fire({toast:true,position:\"top\",text:\"Something went wrong!\",icon:\"info\",showConfirmButton:false,timer:3000}).then(willProceed=>{//scroll to top after notification\nweatherAPI.scrollToElement(\"weatherContainer\");});}else{//if API call was successful\nif(result.cod==200){weatherAPI.updateReactDom(result);weatherAPI.scrollToElement(\"weatherContainer\");}}},error:(xhr,status,error)=>{Swal.fire({toast:true,text:error,icon:\"warning\",timer:2000,position:\"top\",showConfirmButton:false}).then(willProceed=>{// @see line 52\nweatherAPI.scrollToElement(\"weatherContainer\");});}});});}},error,OPTIONS);}else{Swal.fire({toast:true,text:\"Geolocation not supported!\",icon:\"error\",position:\"top\",showConfirmButton:false,timer:3000});}};export default getGeolocation;","map":{"version":3,"names":["jQuery","db","Swal","weatherAPI","getGeolocation","navigator","geolocation","OPTIONS","enableHighAccuracy","maximumAge","timeout","Infinity","error","fire","toast","text","message","icon","timer","position","showConfirmButton","then","willProceed","scrollToElement","watchPosition","get","create","coords","longitude","latitude","$","noConflict","URL","concat","API_KEY","WEATHER_UNIT","ajax","url","processData","success","result","status","xhr","cod","updateReactDom"],"sources":["/Users/ondal/react/react-weather-app/src/apis/getGeolocation.js"],"sourcesContent":["import jQuery from \"jquery\";\nimport { db } from \"../backend/app_backend\";\nimport Swal from \"sweetalert2\";\nimport * as weatherAPI from \"./getCurrentWeather\";\nconst getGeolocation = () => {\n\t//check if the user's device supports Geolocation API\n\tif (navigator.geolocation) {\n\t\tconst OPTIONS = {\n\t\t\tenableHighAccuracy: true,\n\t\t\tmaximumAge: 0,\n\t\t\ttimeout: Infinity,\n\t\t};\n\t\tconst error = (error) => {\n\t\t\tSwal.fire({\n\t\t\t\ttoast: true,\n\t\t\t\ttext: error.message,\n\t\t\t\ticon: \"warning\",\n\t\t\t\ttimer: 1000,\n\t\t\t\tposition: \"top\",\n\t\t\t\tshowConfirmButton: false,\n\t\t\t}).then((willProceed)=>{\n\t\t\t\t// @see line 52\n\t\t\t\tweatherAPI.scrollToElement(\"weatherContainer\");\n\t\t\t\t\n\t\t\t});\n\t\t};\n\t\tnavigator.geolocation.watchPosition(\n\t\t\t(position) => {\n\t\t\t\t//check if the user's position was saved before\n\t\t\t\tif (!db.get(\"USER_LONGITUDE\") && !db.get(\"USER_LATITUDE\")) {\n\t\t\t\t\tdb.create(\"USER_LONGITUDE\", position.coords.longitude);\n\t\t\t\t\tdb.create(\"USER_LATITUDE\", position.coords.latitude);\n\t\t\t\t} else {\n\t\t\t\t\t//if saved, then get the current weather using their coordinates\n\n\t\t\t\t\tjQuery(($) => {\n\t\t\t\t\t\t$.noConflict();\n\n\t\t\t\t\t\tconst longitude = position.coords.longitude || db.get(\"USER_LONGITUDE\"),\n\t\t\t\t\t\t\t  latitude = position.coords.latitude || db.get(\"USER_LATITUDE\");\n\t\t\t\t\t\tconst URL = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${weatherAPI.API_KEY}&units=${weatherAPI.WEATHER_UNIT}`;\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: URL,\n\t\t\t\t\t\t\tprocessData: false,\n\t\t\t\t\t\t\tsuccess: (result, status, xhr) => {\n\t\t\t\t\t\t\t\tif (xhr.status != 200) {\n\t\t\t\t\t\t\t\t\tSwal.fire({\n\t\t\t\t\t\t\t\t\t\ttoast: true,\n\t\t\t\t\t\t\t\t\t\tposition: \"top\",\n\t\t\t\t\t\t\t\t\t\ttext: \"Something went wrong!\",\n\t\t\t\t\t\t\t\t\t\ticon: \"info\",\n\t\t\t\t\t\t\t\t\t\tshowConfirmButton: false,\n\t\t\t\t\t\t\t\t\t\ttimer: 3000,\n\t\t\t\t\t\t\t\t\t}).then((willProceed)=>{\n\t\t\t\t\t\t\t\t\t\t//scroll to top after notification\n\t\t\t\t\t\t\t\t\t\tweatherAPI.scrollToElement(\"weatherContainer\");\n\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t//if API call was successful\n\t\t\t\t\t\t\t\t\tif (result.cod == 200) {\n\t\t\t\t\t\t\t\t\t\tweatherAPI.updateReactDom(result);\n\t\t\t\t\t\t\t\t\t\tweatherAPI.scrollToElement(\"weatherContainer\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\terror: (xhr, status, error) => {\n\t\t\t\t\t\t\t\tSwal.fire({\n\t\t\t\t\t\t\t\t\ttoast: true,\n\t\t\t\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\t\t\t\ticon: \"warning\",\n\t\t\t\t\t\t\t\t\ttimer: 2000,\n\t\t\t\t\t\t\t\t\tposition: \"top\",\n\t\t\t\t\t\t\t\t\tshowConfirmButton: false,\n\t\t\t\t\t\t\t\t}).then((willProceed)=>{\n\t\t\t\t\t\t\t\t\t// @see line 52\n\t\t\t\t\t\t\t\t\tweatherAPI.scrollToElement(\"weatherContainer\");\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\terror,\n\t\t\tOPTIONS\n\t\t);\n\t} else {\n\t\tSwal.fire({\n\t\t\ttoast: true,\n\t\t\ttext: \"Geolocation not supported!\",\n\t\t\ticon: \"error\",\n\t\t\tposition: \"top\",\n\t\t\tshowConfirmButton: false,\n\t\t\ttimer: 3000,\n\t\t});\n\t}\n};\n\nexport default getGeolocation;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}